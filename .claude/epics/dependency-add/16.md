---
name: Implement add command structure with argument and flag parsing
status: open
created: 2025-09-06T21:39:41Z
updated: 2025-09-06T21:45:32Z
github: https://github.com/torynet/gh-issue-dependency/issues/16
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Implement add command structure with argument and flag parsing

## Description
Create the foundational `add` command structure in cmd/add.go with proper Cobra integration, argument parsing, and flag validation. This establishes the command interface that supports both "blocks" and "blocked-by" relationships with mutual exclusion validation and dry run support.

## Acceptance Criteria
- [ ] cmd/add.go created with proper Cobra command structure
- [ ] Command registered with root command via init() function
- [ ] Accepts single issue number argument with validation (cobra.ExactArgs(1))
- [ ] Mutual exclusive flags: --blocked-by and --blocks with proper validation
- [ ] Support for GitHub issue URLs as argument and flag inputs
- [ ] Global --repo flag integration for cross-repository operations
- [ ] --dry-run flag for preview mode
- [ ] Basic help text and usage examples following gh CLI conventions
- [ ] Flag combination validation with clear error messages

## Technical Details
- **Implementation approach**: Follow gh-sub-issue command patterns with mutual exclusion validation
- **Key considerations**: Flag mutual exclusion, issue number/URL parsing, dry run mode setup
- **Code locations**: cmd/add.go

Command signatures to implement:
```bash
gh issue-dependency add <issue-number> --blocked-by <target-issue>
gh issue-dependency add <issue-number> --blocks <target-issue>
gh issue-dependency add <github-url> --blocked-by <target-url>
gh issue-dependency add 123 --blocks 124 --repo owner/repo
gh issue-dependency add 123 --blocked-by 124 --dry-run
```

Key patterns to implement:
```go
var addCmd = &cobra.Command{
    Use:   "add <issue-number>",
    Short: "Add dependency relationships between issues",
    Long:  `Create "blocks" or "blocked-by" relationships between GitHub issues...`,
    Args:  cobra.ExactArgs(1),
    RunE:  runAdd,
}

func init() {
    addCmd.Flags().String("blocked-by", "", "Issue that blocks the target issue")
    addCmd.Flags().String("blocks", "", "Issue that is blocked by the target issue")
    addCmd.MarkFlagsMutuallyExclusive("blocked-by", "blocks")
    addCmd.Flags().Bool("dry-run", false, "Preview changes without executing")
}
```

## Dependencies
- [ ] cli-foundation epic completed (root command structure exists)
- [ ] Cobra framework available and properly configured
- [ ] Repository context detection utilities from cli-foundation

## Effort Estimate
- Size: M
- Hours: 2-3 hours
- Parallel: false (foundational component)

## Definition of Done
- [ ] `gh issue-dependency add --help` shows proper help information
- [ ] Command accepts issue numbers with --blocked-by or --blocks flags
- [ ] Flag mutual exclusion validation works correctly
- [ ] GitHub URLs are parsed and validated correctly
- [ ] --dry-run flag is recognized and preserved for later phases
- [ ] Error messages are clear and actionable for invalid flag combinations
- [ ] Code follows gh-sub-issue command patterns
