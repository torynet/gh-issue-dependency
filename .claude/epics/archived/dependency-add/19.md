---
name: Implement user experience features with dry run and enhanced error messaging
status: open
created: 2025-09-06T21:39:41Z
updated: 2025-09-06T21:45:33Z
github: https://github.com/torynet/gh-issue-dependency/issues/19
depends_on: [18]
parallel: true
conflicts_with: []
---

# Task: Implement user experience features with dry run and enhanced error messaging

## Description
Create comprehensive user experience features including dry run mode with detailed previews, enhanced error messages with recovery guidance, success confirmations, and output formatting that follows gh-sub-issue patterns for consistency and usability.

## Acceptance Criteria
- [ ] Dry run mode shows detailed preview of intended changes
- [ ] Dry run includes validation check results with status indicators
- [ ] Enhanced error messages with specific recovery guidance for each error type
- [ ] Success confirmation messages with relationship details
- [ ] Output formatting follows gh-sub-issue visual patterns
- [ ] Progress indicators during validation and API operations
- [ ] Contextual help for common error scenarios
- [ ] Integration with TTY detection for colored vs. plain output

## Technical Details
- **Implementation approach**: Comprehensive output formatting with dry run preview and enhanced error messaging
- **Key considerations**: User guidance, visual consistency, TTY detection
- **Code locations**: pkg/output.go (or similar), integration with cmd/add.go

Output format examples:

**Dry Run Success**:
```text
Dry run: dependency creation preview

Would create:
  ✓ blocked-by relationship: #123 ← #45 (Database migration setup)

Validation checks:
  ✓ Issues exist and are accessible
  ✓ User has write permissions  
  ✓ No circular dependency detected
  ✓ Relationship does not already exist

Use --force to skip confirmation or remove --dry-run to execute.
```

**Success Confirmation**:
```text
Creating dependency for: #123 - Feature: User Authentication System

✅ Added blocked-by relationship: #123 ← #45 (Database migration setup)

Dependency created successfully.
```

**Enhanced Error Messages**:
```text
❌ Cannot create dependency: circular dependency detected
   #123 → #45 → #67 → #123

This would create a circular dependency. Consider breaking the cycle by:
- Removing the dependency from #67 to #123, or  
- Restructuring the dependency relationships
- Use 'gh issue-dependency list #67' to see current dependencies
```

**Permission Error with Guidance**:
```text
❌ Permission denied: insufficient write access to owner/repo

To resolve this issue:
- Ensure you have "Issues" write permissions for this repository
- Contact the repository owner to request access
- Verify your GitHub authentication: gh auth status
```

Key functions to implement:
```go
func formatDryRunOutput(source, target IssueRef, relType string, validationResults ValidationResults) string
func formatSuccessMessage(source, target IssueRef, relType string) string
func formatValidationError(err error, source, target IssueRef) string
func formatAPIError(err error, context string) string
```

## Dependencies
- [ ] Task 003 completed (API integration provides results to format)
- [ ] Understanding of gh-sub-issue output patterns
- [ ] TTY detection capabilities for colored output

## Effort Estimate
- Size: S
- Hours: 1-2 hours
- Parallel: true (can work alongside testing)

## Definition of Done
- [ ] Dry run mode provides comprehensive preview with validation status
- [ ] All error types have specific, actionable recovery guidance
- [ ] Success messages clearly indicate what was created
- [ ] Output formatting matches gh-sub-issue visual patterns
- [ ] TTY detection works for colored vs. plain output
- [ ] Progress indicators enhance user experience during operations
- [ ] User experience is intuitive and informative across all scenarios
